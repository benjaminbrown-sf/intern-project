import React from 'react';
import {
  createMuiTheme,
  ThemeProvider,
  makeStyles,
} from '@material-ui/core/styles';
import Button from './elements/Button';
import theme from './theme';
import { useGet, CommitmentsQueryParams } from './hooks/axiosHooks';

import RecurringPaymentsTable from './components/RecurringPaymentsTable';

const MUITheme = createMuiTheme(theme);

// css styles for App are specified here. The className is generated by 'makeStyles' when
// the 'useAppStyles' hook is run
const useAppStyles = makeStyles(theme => {
  return {
    app: {
      textAlign: 'center',
    },
    appHeader: {
      display: 'flex',
      flexDirection: 'column',
      alignItems: 'center',
      justifyContent: 'center',
      fontSize: 'calc(10px + 2vmin)',
      color: 'white',
    },
    appLogo: {
      height: '100px',
      pointerEvents: 'none',
    },
    errorText: {
      color: theme.palette.error.main,
    },
    response: {
      fontFamily: 'monospace',
      whiteSpace: 'pre',
      textAlign: 'left',
    },
  };
});

const App = (): JSX.Element => {
  const classes = useAppStyles();

  const queryParams: CommitmentsQueryParams = {
    limit: 10,
    page: 0,
    sortField: 'firstName',
  };

  // This hook requests data from the mock server.
  // This component will re-render every time the state of this request changes:
  // when it sends the request, when it stops loading, when it has an error,
  // when it has a result
  const [response, loading, error] = useGet('commitments', queryParams);

  return (
    <ThemeProvider theme={MUITheme}>
      <div className={classes.app}>
        <header className={classes.appHeader}>
          <img src="logo.png" className={classes.appLogo} alt="logo" />
        </header>
        <p>
          Edit <code>src/App.js</code> and save to reload.
        </p>
        <div>
          <h4> Buttons Example </h4>
          <Button type="primary">Primary Button</Button>
          <Button type="secondary">Secondary Button</Button>
          <Button disabled type="primary">
            Disabled Button
          </Button>
        </div>
        <div>
          {response ? (
            <RecurringPaymentsTable response={response.data} />
          ) : null}
        </div>
        <div>
          <h4> Network Request Example </h4>
          <div>
            {loading ? <p> Loading...</p> : null}
            {error ? (
              <p className={classes.errorText}>
                There was an error making the request.
              </p>
            ) : null}
            {response ? (
              <div className={classes.response}>
                {JSON.stringify(response.data, null, 2)}{' '}
              </div>
            ) : null}
          </div>
        </div>
      </div>
    </ThemeProvider>
  );
};

export default App;
